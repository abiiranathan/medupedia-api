(()=>{"use strict";var e={755:(e,t)=>{async function s(e){const t=await fetch(e);if(200==t.status)return await t.json();throw new Error(t.statusText)}Object.defineProperty(t,"__esModule",{value:!0}),t.handleUpdateDisease=t.handleSaveNewDisease=t.fetchDiseases=t.fetchSigns=t.fetchSymptoms=void 0,t.fetchSymptoms=async()=>await s("/api/symptoms/?query={id, name, description}"),t.fetchSigns=async()=>await s("/api/signs/?query={id, name, description}"),t.fetchDiseases=async()=>await s("/api/diseases/?query={id, name, signs, symptoms, about}"),t.handleSaveNewDisease=async function(e){const t={method:"POST",body:JSON.stringify(e),headers:{"content-type":"application/json"}},s=await fetch("/api/diseases/",t),a=await s.json();if(201===s.status)return a;if("object"==typeof a&&(null==Object?void 0:Object.keys(a).includes("name")))throw new Error(`${e.name} has already been registered`);throw new Error(s.statusText)},t.handleUpdateDisease=async function(e,t){const s={method:"PATCH",body:JSON.stringify(t),headers:{"content-type":"application/json"}},a=await fetch(`/api/diseases/${e}/`,s),n=await a.json();if(a.ok)return n;throw new Error(a.statusText)}},176:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=e=>`\n        <li>\n            <small><b>${e.name}</b></small><br>\n            <small>${e.description}</small>\n        </li>`,a=e=>`\n        <li>\n            <small><b>${e.name}</b></small><br>\n            <small>${e.description}</small>\n        </li>`;t.default=function(e){var t;return`\n  <div>\n    <h2 id="disease__name">\n        <span style="cursor: pointer; transform:scale(2)">&#8592;</span> \n        ${e.name}\n    </h2>\n    <hr />\n    ${(null===(t=null==e?void 0:e.about)||void 0===t?void 0:t.length)>0?'<h4 class="section">Description</h4>':""}\n    <p id="disease__about">${e.about}</p>\n    ${e.symptoms.length>0?'<h4 class="section">Symptoms</h4>':""}\n    <ul id="disease__symptoms">\n        ${e.symptoms.map(s).join("\n")}\n    </ul>\n    ${e.signs.length>0?'<h4 class="section">Signs</h4>':""}\n    <ul id="disease__symptoms">\n        ${e.signs.map(a).join("\n")}\n    </ul>\n    <button id="backButton" class="btn">Back</span></button>\n    <button id="editButton" class="btn">Edit</button>\n  </div>\n  `}},815:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hideSpinner=t.showSpinner=t.hideErrorMessage=t.showErrorMessage=t.hideNameExists=t.showNameExists=t.openTab=t.editDisease=t.hideDiseaseDetail=t.setUpDiseases=t.populateDiseases=t.setUpSigns=t.setUpSymptoms=t.editForm=t.addDiseaseForm=t.diseaseList=t.searchInput=t.rmvSignBtn=t.addSignBtn=t.filter_signs=t.chosen_signs=t.available_signs=t.rmvSymptomBtn=t.addSymptomBtn=t.filter_symptoms=t.chosen_symptoms=t.available_symptoms=t.tabWidget=t.tabs=void 0;const a=s(724);t.tabs=document.querySelectorAll(".tablinks"),t.tabWidget=document.querySelector(".tabWidget"),t.available_symptoms=document.getElementById("available_symptoms"),t.chosen_symptoms=document.getElementById("chosen_symptoms"),t.filter_symptoms=document.getElementById("filter_symptoms"),t.addSymptomBtn=document.querySelector("button.arrow.right"),t.rmvSymptomBtn=document.querySelector("button.arrow.left"),t.available_signs=document.getElementById("available_signs"),t.chosen_signs=document.getElementById("chosen_signs"),t.filter_signs=document.getElementById("filter_signs"),t.addSignBtn=document.querySelector("button.arrow.right.sign"),t.rmvSignBtn=document.querySelector("button.arrow.left.sign"),t.searchInput=document.querySelector(".search-diseases"),t.diseaseList=document.querySelector("#disease_list"),t.addDiseaseForm=document.querySelector("#add-disease-form"),t.editForm=document.getElementById("edit-disease-form");const n=s(337);function i(e,s=!0){var a,i;s&&(t.diseaseList.innerHTML="");for(const s of e){const e=document.createElement("li"),o=document.createTextNode(s.name);e.setAttribute("id",s.id.toString()),e.title=null!==(i=null===(a=s.about)||void 0===a?void 0:a.slice(0,20))&&void 0!==i?i:"",e.appendChild(o),e.addEventListener("click",(()=>{n.showDiseaseDetail(s)})),t.diseaseList.appendChild(e)}}function o(){t.tabWidget.style.display="block";const e=document.querySelector(".disease-detail");e.innerHTML="",e.style.display="none",localStorage.setItem(n.TABS_OPEN,n.STATES.OPEN),localStorage.setItem(n.DISEASE,JSON.stringify(null))}t.setUpSymptoms=e=>{new a.default(t.available_symptoms,t.chosen_symptoms,t.filter_symptoms,t.addSymptomBtn,t.rmvSymptomBtn,e).start()},t.setUpSigns=e=>{new a.default(t.available_signs,t.chosen_signs,t.filter_signs,t.addSignBtn,t.rmvSignBtn,e).start()},t.populateDiseases=i,t.setUpDiseases=function(e){i(e),t.searchInput.addEventListener("input",(t=>{i(e.filter((e=>e.name.toLocaleLowerCase().indexOf(t.target.value.toLocaleLowerCase())>-1)))}))},t.hideDiseaseDetail=o,t.editDisease=function(e,s,i){var l;const r=JSON.parse(null!==(l=localStorage.getItem(n.DISEASE))&&void 0!==l?l:""),d=e.find((e=>e.id===(null==r?void 0:r.id)));if(d){o(),t.tabWidget.style.display="none",t.editForm.style.display="block",t.editForm.querySelector(".disease-name").innerHTML=d.name,t.editForm.querySelector("#about").innerHTML=d.about,t.editForm.setAttribute("data-id",d.id.toString());const e=t.editForm.querySelector("#cancel-disease-edit"),l=t.editForm.querySelector("#available_symptoms"),r=t.editForm.querySelector("#chosen_symptoms"),c=t.editForm.querySelector("#filter_symptoms"),m=t.editForm.querySelector("button.arrow.right"),u=t.editForm.querySelector("button.arrow.left"),p=t.editForm.querySelector("#available_signs"),y=t.editForm.querySelector("#chosen_signs"),h=t.editForm.querySelector("#filter_signs"),S=t.editForm.querySelector("button.arrow.right.sign"),f=t.editForm.querySelector("button.arrow.left.sign"),g=e=>{new a.default(p,y,h,S,f,e).start()},v=(e,t,s)=>{for(let s=0;s<e.options.length;s++){const a=e.options[s];t.map((e=>e.name)).includes(a.value)?null==a||a.setAttribute("selected","selected"):null==a||a.removeAttribute("selected")}s()};(e=>{new a.default(l,r,c,m,u,e).start()})(i),g(s),v(l,d.symptoms,(()=>m.click())),v(p,d.signs,(()=>S.click())),e.onclick=()=>n.showDiseaseDetail(d)}},t.openTab=function(e,t){let s,a,n;for(a=document.querySelectorAll(".tabcontent"),s=0;s<a.length;s++)a[s].style.display="none";for(n=document.querySelectorAll(".tablinks"),s=0;s<n.length;s++)n[s].className=n[s].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active"},t.showNameExists=function(e){const t=document.querySelectorAll(".error-response");for(let s=0;s<t.length;s++){const a=t[s];a.innerHTML=e,a.style.visibility="visible"}},t.hideNameExists=()=>{const e=document.querySelectorAll(".error-response");for(let t=0;t<e.length;t++)e[t].style.visibility="hidden"},t.showErrorMessage=()=>{document.querySelector(".no-connection").style.display="block"},t.hideErrorMessage=()=>{document.querySelector(".no-connection").style.display="none"},t.showSpinner=()=>{document.querySelector(".loading").style.display="block"},t.hideSpinner=()=>{document.querySelector(".loading").style.display="none"}},724:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t,s,a,n,i){this.start=()=>{this.addBtn.addEventListener("click",(()=>{const e=Array.from(this.available.selectedOptions).map((e=>e.value)),t=Array.from(this.chosen.options).map((e=>e.value));for(const s of e)t.includes(s)||this.addToChosenData(s)})),this.removeBtn.addEventListener("click",(()=>{var e;const t=Array.from(this.chosen.selectedOptions).map((e=>e.value));for(const s of t)null===(e=this.chosen.querySelector(`option[value="${s}"]`))||void 0===e||e.remove(),this.addToAvailable(s)})),this.filter.addEventListener("input",(e=>this.filterData(e.target.value,this.initialData))),this.setData(this.initialData)},this.setData=e=>{this.available.innerHTML="";const t=Array.from(this.chosen.options).map((e=>e.value));e.filter((e=>!t.includes(e.name))).forEach((({name:e})=>{const t=document.createElement("option");t.value=e,t.appendChild(document.createTextNode(e)),this.available.appendChild(t)}))},this.filterData=(e,t)=>{if(""!==e){const s=t.filter((t=>t.name.toLowerCase().indexOf(e.toLowerCase())>-1));this.setData(s)}else this.setData(t)},this.addToChosenData=e=>{const t=document.createElement("option");t.value=e,t.appendChild(document.createTextNode(e)),this.chosen.appendChild(t),this.removeFromAvailable(e)},this.removeFromAvailable=e=>{var t;null===(t=this.available.querySelector(`option[value="${e}"]`))||void 0===t||t.remove()},this.addToAvailable=e=>{const t=document.createElement("option");t.value=e,t.appendChild(document.createTextNode(e)),this.available.appendChild(t)},this.available=e,this.chosen=t,this.filter=s,this.addBtn=a,this.removeBtn=n,this.initialData=i}}},337:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.showDiseaseDetail=t.STATES=t.DISEASE=t.TABS_OPEN=void 0;const a=s(755),n=s(815),i=s(176);let o,l,r;function d(e){n.tabWidget.style.display="none",n.editForm.style.display="none";const s=document.querySelector(".disease-detail");s.innerHTML="",s.innerHTML=i.default(e),s.style.display="block",localStorage.setItem(t.TABS_OPEN,t.STATES.NOT_OPEN),localStorage.setItem(t.DISEASE,JSON.stringify(e));const a=document.querySelector("#disease__name > span"),d=document.getElementById("backButton"),c=document.getElementById("editButton");d&&a&&(d.onclick=()=>n.hideDiseaseDetail(),a.onclick=()=>n.hideDiseaseDetail()),c&&(c.onclick=()=>n.editDisease(r,o,l))}t.TABS_OPEN="tabs-open",t.DISEASE="disease",t.STATES={OPEN:"yes",NOT_OPEN:"no"},n.addDiseaseForm.addEventListener("submit",(e=>{e.preventDefault(),l&&o&&r&&a.handleSaveNewDisease((()=>{const e=n.addDiseaseForm.querySelector("#name").value,t=n.addDiseaseForm.querySelector("#about").value;return{name:e,symptoms:l.filter((e=>Array.from(n.chosen_symptoms.options).map((e=>e.value)).includes(e.name))),signs:o.filter((e=>Array.from(n.chosen_signs.options).map((e=>e.value)).includes(e.name))),about:t}})()).then((e=>{n.populateDiseases([e],!1),n.hideDiseaseDetail(),alert(`${e.name} registered successfully!`)})).catch((e=>{n.showNameExists(e)}))})),n.addDiseaseForm.querySelector("#name").addEventListener("input",(e=>{const t=e.target,s=t.value.trim(),a=`${s} is already registered`;r.map((e=>e.name)).includes(s)?(t.style.borderColor="tomato",n.showNameExists(a)):(t.style.borderColor="lightblue",n.hideNameExists())})),n.editForm.addEventListener("submit",(async e=>{e.preventDefault();const t=e.currentTarget,s=t.querySelector("#chosen_symptoms"),i=t.querySelector("#chosen_signs"),d=t.getAttribute("data-id");if(d){const e=t.querySelector("#about").value,c={symptoms:l.filter((e=>Array.from(s.options).map((e=>e.value)).includes(e.name))),signs:o.filter((e=>Array.from(i.options).map((e=>e.value)).includes(e.name))),about:e};try{const e=await a.handleUpdateDisease(d,c);r=r.map((t=>t.id===e.id?e:t)),n.populateDiseases(r,!0),n.hideDiseaseDetail(),n.editForm.style.display="none",alert(`${e.name} updated successfully!`)}catch(e){console.log(e)}}})),t.showDiseaseDetail=d,document.addEventListener("DOMContentLoaded",(async function(){for(let e=0;e<n.tabs.length;e++){const t=n.tabs[e];t.addEventListener("click",(e=>{n.openTab(e,t.getAttribute("data-target"))})),document.querySelector("button[defaultOpen]").click()}try{n.showSpinner();let[e,t,s]=await Promise.all([a.fetchDiseases(),a.fetchSymptoms(),a.fetchSigns()]);n.hideErrorMessage(),l=t,o=s,r=e,n.setUpSymptoms(l),n.setUpSigns(o),n.setUpDiseases(r)}catch(e){n.showErrorMessage()}finally{n.hideSpinner()}const e=JSON.parse(localStorage.getItem(t.DISEASE));if(null!=e&&localStorage.getItem(t.TABS_OPEN)===t.STATES.NOT_OPEN){const s=r.find((t=>t.id===(null==e?void 0:e.id)));s?d(s):(localStorage.removeItem(t.DISEASE),n.hideDiseaseDetail())}else n.hideDiseaseDetail()}))}},t={};!function s(a){if(t[a])return t[a].exports;var n=t[a]={exports:{}};return e[a](n,n.exports,s),n.exports}(337)})();
//# sourceMappingURL=main.js.map